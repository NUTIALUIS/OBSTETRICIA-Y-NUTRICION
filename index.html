<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OBSTNUT - Sistema de Historia Cl√≠nica</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <style>
        body { padding: 20px; background: #f9f0ff; }
        .form-container { max-width: 800px; margin: auto; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 0 20px rgba(0,0,0,0.1); margin-bottom: 30px; }
        .hidden { display: none; }
        .logout-btn { position: absolute; top: 20px; right: 20px; }
        .card-paciente { margin-bottom: 15px; border-left: 4px solid #9C27B0; }
        .btn-guardar { background: #9C27B0; color: white; }
        .btn-danger { background: #e91e63; color: white; }
        .brand-title { color: #9C27B0; font-weight: bold; }
        .console-log { background: #2c2c2c; color: #00ff00; padding: 10px; border-radius: 5px; font-family: monospace; margin-top: 10px; white-space: pre-wrap; }
    </style>
</head>
<body>

<!-- Login / Registro -->
<div id="auth-section" class="form-container">
    <h3 class="text-center mb-4 brand-title">üîê Acceso Profesional - OBSTNUT</h3>
    <input type="email" id="email" class="form-control mb-3" placeholder="Tu email profesional" required>
    <input type="password" id="password" class="form-control mb-3" placeholder="Contrase√±a (m√≠nimo 6 caracteres)" required>
    <button onclick="login()" class="btn btn-primary w-100 mb-2">Ingresar</button>
    <button onclick="register()" class="btn btn-outline-secondary w-100">Crear Cuenta (solo t√∫)</button>
    <div id="auth-message" class="mt-3 text-center text-danger"></div>
    <div id="debug-console" class="console-log">[Consola de depuraci√≥n - OBSTNUT]</div>
</div>

<!-- Panel Principal -->
<div id="main-app" class="hidden">
    <button onclick="logout()" class="btn btn-outline-danger logout-btn">Cerrar Sesi√≥n</button>
    <h2 class="text-center">üéâ ¬°Bienvenida a OBSTNUT!</h2>
</div>

<script>
    // ‚ö†Ô∏è ‚ö†Ô∏è ‚ö†Ô∏è PEGA AQU√ç TU CONFIGURACI√ìN DE FIREBASE ‚ö†Ô∏è ‚ö†Ô∏è ‚ö†Ô∏è
    const firebaseConfig = {
        apiKey: "PEGAAQUI-TU-API-KEY",
        authDomain: "obstnut-app.firebaseapp.com",
        projectId: "obstnut-app",
        storageBucket: "obstnut-app.appspot.com",
        messagingSenderId: "PEGAAQUI-TU-ID",
        appId: "PEGAAQUI-TU-APP-ID"
    };

    // Funci√≥n para mostrar logs en pantalla
    function log(msg) {
        const consola = document.getElementById('debug-console');
        consola.innerText += `\n> ${msg}`;
        console.log(msg);
    }

    log("üöÄ Iniciando OBSTNUT...");

    try {
        firebase.initializeApp(firebaseConfig);
        log("‚úÖ Firebase inicializado correctamente");
    } catch (error) {
        log(`‚ùå Error al inicializar Firebase: ${error.message}`);
    }

    const auth = firebase.auth();
    const db = firebase.firestore();

    function showMessage(msg) {
        document.getElementById('auth-message').innerText = msg;
        setTimeout(() => document.getElementById('auth-message').innerText = '', 6000);
    }

    function showAuth() {
        document.getElementById('auth-section').classList.remove('hidden');
        document.getElementById('main-app').classList.add('hidden');
    }

    function showApp() {
        document.getElementById('auth-section').classList.add('hidden');
        document.getElementById('main-app').classList.remove('hidden');
    }

    function register() {
        log("üìù Intentando registrar usuario...");
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;

        if (!email || !password || password.length < 6) {
            showMessage("‚ö†Ô∏è Email y contrase√±a (m√≠n. 6 caracteres) son obligatorios.");
            log("‚ùå Validaci√≥n fallida: campos incompletos");
            return;
        }

        auth.createUserWithEmailAndPassword(email, password)
            .then(() => {
                log("‚úÖ Usuario creado con √©xito");
                showMessage("‚úÖ ¬°Cuenta creada! Bienvenida a OBSTNUT.");
                showApp();
            })
            .catch(error => {
                log(`‚ùå Error en registro: ${error.code} - ${error.message}`);
                showMessage("‚ùå Error: " + error.message);
            });
    }

    function login() {
        log("üîë Intentando iniciar sesi√≥n...");
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;

        if (!email || !password) {
            showMessage("‚ö†Ô∏è Email y contrase√±a son obligatorios.");
            log("‚ùå Validaci√≥n fallida: campos vac√≠os");
            return;
        }

        auth.signInWithEmailAndPassword(email, password)
            .then(() => {
                log("‚úÖ Login exitoso");
                showMessage("‚úÖ ¬°Bienvenida a OBSTNUT!");
                showApp();
            })
            .catch(error => {
                log(`‚ùå Error en login: ${error.code} - ${error.message}`);
                showMessage("‚ùå Error: " + error.message);
            });
    }

    function logout() {
        auth.signOut();
        showAuth();
    }

    auth.onAuthStateChanged(user => {
        if (user) {
            log(`‚úÖ Usuario autenticado: ${user.email}`);
            showApp();
        } else {
            log("‚ÑπÔ∏è Ning√∫n usuario autenticado");
            showAuth();
        }
    });

    showAuth();
    log("üèÅ OBSTNUT listo para usar");
</script>

</body>
</html>
